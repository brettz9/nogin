{"version":3,"file":"groupsController.iife.min.js","sources":["../polyfills/Error.js","../views/utilities/ConfirmDialog.js","../views/utilities/AlertDialog.js","../views/groups.js","groupsController.js"],"sourcesContent":["/* eslint-disable no-restricted-globals, no-shadow -- Polyfill */\n// For IE 5.5 (needed per `eslint-plugin-compat`)\nif (typeof Error === 'undefined') {\n  /**\n   * Error polyfill.\n   */\n  // @ts-expect-error Ok for browser\n  window.Error = class Error {};\n}\n","/* globals $ -- `$` is jQuery not ESM */\n\nconst ConfirmDialog = {\n  /**\n   * @param {{\n   *   type: string,\n   *   header: string,\n   *   body: string|Element,\n   *   cancel: string,\n   *   submit: string\n   * }} cfg\n   * @returns {import('./AlertDialog.js').JQueryWithModal}\n   */\n  populate ({\n    type,\n    header,\n    body,\n    cancel,\n    submit\n  }) {\n    const baseSel = `[data-confirm-type=\"${type}\"][data-name=modal-confirm]`;\n    /** @type {import('./AlertDialog.js').JQueryWithModal} */ (\n      $(baseSel)).modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    $(`${baseSel} .modal-header [data-name=modal-title]`).text(\n      header\n    );\n    $(`${baseSel} [data-name=modal-body] p`).empty().append(\n      body\n    );\n    $(`${baseSel} .cancel`).text(cancel).on('click', () => {\n      /** @type {import('./AlertDialog.js').JQueryWithModal} */ (\n        $(baseSel)\n      ).modal('hide');\n    });\n    $(`${baseSel} .submit`).text(submit);\n    return /** @type {import('./AlertDialog.js').JQueryWithModal} */ (\n      $(baseSel)\n    );\n  },\n\n  /**\n   * @param {JQuery} confirmDialog\n   * @returns {JQuery}\n   */\n  getSubmit (confirmDialog) {\n    return confirmDialog.find('.submit');\n  }\n};\n\nexport default ConfirmDialog;\n","/* globals $ -- `$` is jQuery not ESM */\n\n/**\n * @typedef {JQuery & {\n *   modal: (showOrHide: \"show\"|\"hide\"|{\n *     show: boolean,\n *     keyboard: boolean,\n *     backdrop: boolean|\"static\"\n *   }) => JQueryWithModal\n * }} JQueryWithModal\n */\n\nconst AlertDialog = {\n  /**\n   * @param {object} cfg\n   * @param {string} cfg.heading\n   * @param {Element|string} cfg.body\n   * @param {boolean} cfg.keyboard\n   * @param {boolean|\"static\"} cfg.backdrop\n   * @returns {JQueryWithModal} `HTMLDivElement`\n   */\n  populate ({\n    heading,\n    body,\n    keyboard,\n    backdrop\n  }) {\n    const modal = /** @type {JQueryWithModal} */ (\n      $('[data-name=modal-alert]')).modal({\n      show: false, keyboard, backdrop\n    });\n    $('[data-name=modal-alert] .modal-header [data-name=modal-title]').text(\n      heading\n    );\n    $('[data-name=modal-alert] [data-name=modal-body] p').empty().append(body);\n    $('[data-name=modal-alert] button').on('click', (e) => {\n      e.preventDefault();\n      modal.modal('hide');\n    });\n    return modal;\n  }\n};\n\nexport default AlertDialog;\n","/* globals $, Nogin -- `$` is jQuery not ESM, `Nogin` is server-set */\n\nimport ConfirmDialog from './utilities/ConfirmDialog.js';\nimport AlertDialog from './utilities/AlertDialog.js';\n\nconst {_} = Nogin;\n\n/**\n * @param {object} cfg\n * @param {string} [cfg.type]\n * @param {string} [cfg.message]\n * @param {string} [cfg.group]\n * @param {\"error\"|\"success\"} cfg.heading\n * @returns {import('./utilities/AlertDialog.js').\n *   JQueryWithModal} `HTMLDivElement`\n */\nfunction lockedAlert ({type, message, group, heading}) {\n  return AlertDialog.populate({\n    heading: /** @type {string} */ (_(heading)),\n    body: message || _(\n      /** @type {string} */ (type),\n      group\n        ? {lb: $('<br/>')[0], group}\n        : {},\n      {\n        // We're accepting a variety of messages here so no big deal\n        //   if missing a line break (e.g., some even with `group`)\n        throwOnExtraSuppliedFormatters: false\n      }\n    ),\n    keyboard: false,\n    backdrop: 'static'\n  });\n}\n\nconst GroupsView = {\n  /**\n   * @param {JQuery} lockedAlertDialog\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  getLockedAlertButton (lockedAlertDialog) {\n    return lockedAlertDialog.find('button');\n  },\n\n  /**\n   * @returns {JQuery<HTMLElement>}\n   */\n  getDeleteGroups () {\n    return $('button.deleteGroup');\n  },\n\n  /**\n   * @returns {JQuery<HTMLElement>}\n   */\n  getRemoveUserFromGroup () {\n    return $('button.removeUserFromGroup');\n  },\n\n  /**\n   * @returns {JQuery} `HTMLDivElement`\n   */\n  getAddPrivilegeToGroupButton () {\n    return $('button.addPrivilegeToGroup');\n  },\n\n  /**\n   * @returns {import('../views/utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  addPrivilegeToGroupModal () {\n    const addPrivilegeToGroupModal =\n      /**\n       * @type {import('../views/utilities/AlertDialog.js').\n       *   JQueryWithModal}\n       */ (\n        $('#addPrivilegeToGroup')\n      );\n    addPrivilegeToGroupModal.modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    return addPrivilegeToGroupModal;\n  },\n\n  /**\n   * @param {JQuery} addPrivilegeToGroupModal `HTMLDivElement`\n   * @returns {import('../utilities/ajaxFormClientSideValidate.js').\n   *   JQueryWithAjaxForm} `HTMLFormElement`\n   */\n  addPrivilegeToGroupForm (addPrivilegeToGroupModal) {\n    return (\n    /**\n     * @type {import('../utilities/ajaxFormClientSideValidate.js').\n     * JQueryWithAjaxForm}\n     */\n      (addPrivilegeToGroupModal.find('#addPrivilegeToGroup-form'))\n    );\n  },\n\n  /**\n   * @returns {HTMLInputElement}\n   */\n  getAddPrivilegeToGroupGroup () {\n    return /** @type {HTMLInputElement} */ ($('#addPrivilegeToGroup-input')[0]);\n  },\n\n  /**\n   * @param {JQuery} addPrivilegeToGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  addPrivilegeToGroupCancel (addPrivilegeToGroupModal) {\n    return addPrivilegeToGroupModal.find(\n      '[data-name=addPrivilegeToGroup-cancel]'\n    );\n  },\n\n  /**\n   * @param {JQuery} addPrivilegeToGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  addPrivilegeToGroupSubmit (addPrivilegeToGroupModal) {\n    return addPrivilegeToGroupModal.find(\n      '[data-name=addPrivilegeToGroup-submit]'\n    );\n  },\n\n  /**\n   * @returns {import('../views/utilities/AlertDialog.js').\n  *   JQueryWithModal} `HTMLDivElement`\n  */\n  createGroupModal () {\n    const createGroupModal =\n      /**\n      * @type {import('../views/utilities/AlertDialog.js').\n      *   JQueryWithModal}\n      */ (\n        $('#createGroup')\n      );\n    createGroupModal.modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    return createGroupModal;\n  },\n\n  /**\n   * @returns {import('../views/utilities/AlertDialog.js').\n  *   JQueryWithModal} `HTMLDivElement`\n  */\n  renameGroupModal () {\n    const renameGroupModal =\n      /**\n      * @type {import('../views/utilities/AlertDialog.js').\n      *   JQueryWithModal}\n      */ (\n        $('#renameGroup')\n      );\n    renameGroupModal.modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    return renameGroupModal;\n  },\n\n  /**\n   * @returns {import('../views/utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  addUserToGroupModal () {\n    const addUserToGroupModal =\n      /**\n      * @type {import('../views/utilities/AlertDialog.js').\n      *   JQueryWithModal}\n      */ (\n        $('#addUserToGroup')\n      );\n    addUserToGroupModal.modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    return addUserToGroupModal;\n  },\n\n  /**\n   * @param {JQuery} createGroupModal `HTMLDivElement`\n   * @returns {import('../utilities/ajaxFormClientSideValidate.js').\n   *   JQueryWithAjaxForm} `HTMLFormElement`\n   */\n  createGroupForm (createGroupModal) {\n    return (\n      /**\n       * @type {import('../utilities/ajaxFormClientSideValidate.js').\n       * JQueryWithAjaxForm}\n       */\n      (createGroupModal.find('#createGroup-form'))\n    );\n  },\n\n  /**\n   * @param {JQuery} renameGroupModal `HTMLDivElement`\n   * @returns {import('../utilities/ajaxFormClientSideValidate.js').\n  *   JQueryWithAjaxForm} `HTMLFormElement`\n  */\n  renameGroupForm (renameGroupModal) {\n    return (\n      /**\n      * @type {import('../utilities/ajaxFormClientSideValidate.js').\n      * JQueryWithAjaxForm}\n      */\n      (renameGroupModal.find('#renameGroup-form'))\n    );\n  },\n\n  /**\n   * @param {JQuery} addUserToGroupModal `HTMLDivElement`\n   * @returns {import('../utilities/ajaxFormClientSideValidate.js').\n   *   JQueryWithAjaxForm} `HTMLFormElement`\n   */\n  addUserToGroupForm (addUserToGroupModal) {\n    return (\n      /**\n      * @type {import('../utilities/ajaxFormClientSideValidate.js').\n      * JQueryWithAjaxForm}\n      */\n      (addUserToGroupModal.find('#addUserToGroup-form'))\n    );\n  },\n\n  /**\n   * @param {JQuery} createGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  createGroupSubmit (createGroupModal) {\n    return createGroupModal.find('[data-name=createGroup-submit]');\n  },\n\n  /**\n   * @param {JQuery} addUserToGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  addUserToGroupSubmit (addUserToGroupModal) {\n    return addUserToGroupModal.find('[data-name=addUserToGroup-submit]');\n  },\n\n  /**\n   * @param {JQuery} renameGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  renameGroupSubmit (renameGroupModal) {\n    return renameGroupModal.find('[data-name=renameGroup-submit]');\n  },\n\n  /**\n   * @param {JQuery} createGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  createGroupCancel (createGroupModal) {\n    return createGroupModal.find('[data-name=createGroup-cancel]');\n  },\n\n  /**\n   * @param {JQuery} addUserToGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  addUserToGroupCancel (addUserToGroupModal) {\n    return addUserToGroupModal.find('[data-name=addUserToGroup-cancel]');\n  },\n\n  /**\n   * @param {JQuery} renameGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  renameGroupCancel (renameGroupModal) {\n    return renameGroupModal.find('[data-name=renameGroup-cancel]');\n  },\n\n  /**\n   * @returns {JQuery} `HTMLDivElement`\n   */\n  getCreateGroupButton () {\n    return $('button.createGroup');\n  },\n\n  /**\n   * @returns {JQuery} `HTMLDivElement`\n   */\n  getRenameGroupButton () {\n    return $('button.renameGroup');\n  },\n\n  /**\n   * @returns {JQuery} `HTMLDivElement`\n   */\n  getAddUserToGroupButton () {\n    return $('button.addUserToGroup');\n  },\n\n  /**\n   * @returns {HTMLInputElement}\n   */\n  getCreateGroupName () {\n    return /** @type {HTMLInputElement} */ ($('#createGroup-input')[0]);\n  },\n\n  /**\n   * @returns {HTMLInputElement}\n   */\n  getAddUserToGroupName () {\n    return /** @type {HTMLInputElement} */ ($('#addUserToGroup-input')[0]);\n  },\n\n  /**\n   * @returns {HTMLInputElement}\n   */\n  getRenameGroupName () {\n    return /** @type {HTMLInputElement} */ ($('#renameGroup-input')[0]);\n  },\n\n  /**\n   * @param {string} group\n   * @returns {import('./utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  setDeleteGroup (group) {\n    const deleteGroupConfirmDialog = ConfirmDialog.populate({\n      type: 'deleteGroup',\n      header: /** @type {string} */ (_('deleteGroup')),\n      body: /** @type {string} */ (_('sureWantDeleteGroup', {\n        group\n      })),\n      cancel: /** @type {string} */ (_('cancel')),\n      submit: /** @type {string} */ (_('delete'))\n    });\n    deleteGroupConfirmDialog.find('.submit').addClass('btn-danger');\n    return /** @type {import('./utilities/AlertDialog.js').JQueryWithModal} */ (\n      deleteGroupConfirmDialog\n    );\n  },\n\n  /**\n   * @returns {import('./utilities/AlertDialog.js').\n  *   JQueryWithModal} `HTMLDivElement`\n  */\n  setRemoveUserFromGroup () {\n    const removeUserFromGroupConfirmDialog = ConfirmDialog.populate({\n      type: 'removeUserFromGroup',\n      header: /** @type {string} */ (_('removeUserFromGroup')),\n      body: /** @type {string} */ (_('reallyWantRemoveUserFromGroup')),\n      cancel: /** @type {string} */ (_('cancel')),\n      submit: /** @type {string} */ (_('delete'))\n    });\n    removeUserFromGroupConfirmDialog.find('.submit').addClass('btn-danger');\n    return /** @type {import('./utilities/AlertDialog.js').JQueryWithModal} */ (\n      removeUserFromGroupConfirmDialog\n    );\n  },\n\n  /**\n   * @returns {JQuery<HTMLElement>}\n   */\n  getRemovePrivilegeFromGroup () {\n    return $('button.removePrivilegeFromGroup');\n  },\n\n  /**\n   * @returns {import('./utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  setRemovePrivilegeFromGroup () {\n    const removePrivilegeFromGroupConfirmDialog = ConfirmDialog.populate({\n      type: 'removePrivilegeFromGroup',\n      header: /** @type {string} */ (_('removePrivilegeFromGroup')),\n      body: /** @type {string} */ (_('reallyWantRemovePrivilegeFromGroup')),\n      cancel: /** @type {string} */ (_('cancel')),\n      submit: /** @type {string} */ (_('delete'))\n    });\n    removePrivilegeFromGroupConfirmDialog.find(\n      '.submit'\n    ).addClass('btn-danger');\n    return /** @type {import('./utilities/AlertDialog.js').JQueryWithModal} */ (\n      removePrivilegeFromGroupConfirmDialog\n    );\n  },\n\n  /**\n   * @param {object} cfg\n   * @param {\"groupCreated\"|\"groupDeleted\"|\"groupRenamed\"|\n   *   \"userRemovedFromGroup\"|\"userAddedToGroup\"|\n   *   \"privilegeAddedToGroup\"|\"privilegeRemovedFromGroup\"} cfg.type\n   * @param {string} [cfg.group]\n   * @returns {import('./utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  onShowLockedAlert ({type, group}) {\n    return lockedAlert({type, group, heading: 'success'});\n  },\n\n  /**\n   * @param {object} cfg\n   * @param {string} cfg.group\n   * @param {string} [cfg.message]\n   * @param {\"ErrorLoggingOut\"|\"FailureSubmittingGroupInfo\"|\n   * \"SessionLost\"|\"ProblemDispatchingLink\"} [cfg.type]\n   * @returns {import('./utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  onShowLockedErrorAlert ({type, group, message}) {\n    return lockedAlert({type, message, group, heading: 'error'});\n  },\n\n  /**\n   * @type {{[key: string]: {[key: string]: string}}}\n   */\n  errorMessages: {\n    name: {\n      PleaseEnterName: /** @type {string} */ (_('PleaseEnterName'))\n    }\n  }\n};\n\nexport default GroupsView;\n","/* globals $, Nogin -- `$` is jQuery not ESM, `Nogin` is server-set */\n\nimport '../polyfills/Error.js';\nimport '../polyfills/console.js';\n\nimport ConfirmDialog from '../views/utilities/ConfirmDialog.js';\nimport GroupsView from '../views/groups.js';\n\n/**\n * @typedef {Error & {\n *   text: string,\n *   responseText: string,\n *   statusText?: string\n * }} AjaxPostError\n */\n\nconst xsrfCookie = $('meta[name=\"csrf-token\"]').attr('content');\n\nconst createGroupButton = GroupsView.getCreateGroupButton();\nconst createGroupModal = GroupsView.createGroupModal();\nconst createGroupForm = GroupsView.createGroupForm(\n  createGroupModal\n);\n\ncreateGroupForm.on('submit', function (e) {\n  e.preventDefault();\n});\ncreateGroupButton.on('click', () => {\n  const createGroupCancel = GroupsView.createGroupCancel(\n    createGroupModal\n  );\n\n  createGroupCancel.on('click', () => {\n    createGroupModal.modal('hide');\n  });\n  createGroupModal.modal('show');\n\n  const createGroupSubmit = GroupsView.createGroupSubmit(\n    createGroupModal\n  );\n  createGroupSubmit.on('click', async () => {\n    try {\n      const groupToCreate = GroupsView.getCreateGroupName();\n      if (groupToCreate.validity.tooShort) {\n        groupToCreate.setCustomValidity(\n          GroupsView.errorMessages.name.PleaseEnterName\n        );\n        /** @type {HTMLFormElement} */ (createGroupForm[0]).reportValidity();\n        return;\n      }\n      await createGroup(groupToCreate.value);\n    } catch (er) {\n      createGroupModal.modal('hide');\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n});\n\nconst renameGroupButton = GroupsView.getRenameGroupButton();\nconst renameGroupModal = GroupsView.renameGroupModal();\nconst renameGroupForm = GroupsView.renameGroupForm(\n  renameGroupModal\n);\n\nrenameGroupForm.on('submit', function (e) {\n  e.preventDefault();\n});\nrenameGroupButton.on('click', (e) => {\n  const groupName = /** @type {string} */ (e.target.dataset.group);\n  const groupToRename = GroupsView.getRenameGroupName();\n\n  const renameGroupCancel = GroupsView.renameGroupCancel(\n    renameGroupModal\n  );\n\n  renameGroupCancel.on('click', () => {\n    renameGroupModal.modal('hide');\n  });\n  renameGroupModal.modal('show');\n  groupToRename.value = groupName;\n\n  const renameGroupSubmit = GroupsView.renameGroupSubmit(\n    renameGroupModal\n  );\n  renameGroupSubmit.on('click', async () => {\n    try {\n      if (groupToRename.validity.tooShort) {\n        groupToRename.setCustomValidity(\n          GroupsView.errorMessages.name.PleaseEnterName\n        );\n        /** @type {HTMLFormElement} */ (renameGroupForm[0]).reportValidity();\n        return;\n      }\n      const newGroupName = groupToRename.value;\n      await renameGroup(groupName, newGroupName);\n    } catch (er) {\n      renameGroupModal.modal('hide');\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n});\n\nconst addUserToGroupButton = GroupsView.getAddUserToGroupButton();\nconst addUserToGroupModal = GroupsView.addUserToGroupModal();\nconst addUserToGroupForm = GroupsView.addUserToGroupForm(\n  addUserToGroupModal\n);\n\naddUserToGroupForm.on('submit', function (e) {\n  e.preventDefault();\n});\naddUserToGroupButton.on('click', (e) => {\n  const groupName = /** @type {string} */ (e.target.dataset.group);\n  const userToAdd = GroupsView.getAddUserToGroupName();\n\n  const addUserToGroupCancel = GroupsView.addUserToGroupCancel(\n    addUserToGroupModal\n  );\n\n  addUserToGroupCancel.on('click', () => {\n    addUserToGroupModal.modal('hide');\n  });\n  addUserToGroupModal.modal('show');\n\n  const addUserToGroupSubmit = GroupsView.addUserToGroupSubmit(\n    addUserToGroupModal\n  );\n  addUserToGroupSubmit.on('click', async () => {\n    try {\n      if (userToAdd.validity.tooShort) {\n        userToAdd.setCustomValidity(\n          GroupsView.errorMessages.name.PleaseEnterName\n        );\n        /** @type {HTMLFormElement} */ (addUserToGroupForm[0]).reportValidity();\n        return;\n      }\n      const userID = userToAdd.value;\n      await addUserToGroup(groupName, userID);\n    } catch (er) {\n      addUserToGroupModal.modal('hide');\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n});\n\nconst addPrivilegeToGroupButton = GroupsView.getAddPrivilegeToGroupButton();\nconst addPrivilegeToGroupModal = GroupsView.addPrivilegeToGroupModal();\nconst addPrivilegeToGroupForm = GroupsView.addPrivilegeToGroupForm(\n  addPrivilegeToGroupModal\n);\n\naddPrivilegeToGroupForm.on('submit', function (e) {\n  e.preventDefault();\n});\naddPrivilegeToGroupButton.on('click', (e) => {\n  const privilegeToAdd = GroupsView.getAddPrivilegeToGroupGroup();\n  const groupName = /** @type {string} */ (e.target.dataset.group);\n\n  const addPrivilegeToGroupCancel = GroupsView.addPrivilegeToGroupCancel(\n    addPrivilegeToGroupModal\n  );\n\n  addPrivilegeToGroupCancel.on('click', () => {\n    addPrivilegeToGroupModal.modal('hide');\n  });\n  addPrivilegeToGroupModal.modal('show');\n\n  const addPrivilegeToGroupSubmit = GroupsView.addPrivilegeToGroupSubmit(\n    addPrivilegeToGroupModal\n  );\n  addPrivilegeToGroupSubmit.on('click', async () => {\n    try {\n      if (privilegeToAdd.validity.tooShort) {\n        privilegeToAdd.setCustomValidity(\n          GroupsView.errorMessages.name.PleaseEnterName\n        );\n        /** @type {HTMLFormElement} */ (\n          addPrivilegeToGroupForm[0]\n        ).reportValidity();\n        return;\n      }\n      await addPrivilegeToGroup(groupName, privilegeToAdd.value);\n    } catch (er) {\n      addPrivilegeToGroupModal.modal('hide');\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n});\n\n/**\n * @param {string} groupName\n * @param {string} privilegeName\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function addPrivilegeToGroup (groupName, privilegeName) {\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'addPrivilegeToGroup', groupName, privilegeName\n  });\n  addPrivilegeToGroupModal.modal('hide');\n  showLockedAlertReload({type: 'privilegeAddedToGroup'});\n}\n\nconst removePrivilegeFromGroupConfirmDialog =\n  GroupsView.setRemovePrivilegeFromGroup();\nGroupsView.getRemovePrivilegeFromGroup().on('click', (e) => {\n  const groupName = /** @type {string} */ (e.target.dataset.group);\n  const privilegeID = /** @type {string} */ (e.target.dataset.privilege);\n\n  ConfirmDialog.getSubmit(\n    removePrivilegeFromGroupConfirmDialog\n  ).on('click', async () => {\n    try {\n      await removePrivilegeFromGroup(groupName, privilegeID);\n    } catch (er) {\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n  removePrivilegeFromGroupConfirmDialog.modal('show');\n});\n\n/**\n * @throws {Error}\n * @param {string} groupName\n * @param {string} privilegeName\n * @returns {Promise<void>}\n */\nasync function removePrivilegeFromGroup (groupName, privilegeName) {\n  removePrivilegeFromGroupConfirmDialog.modal('hide');\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'removePrivilegeFromGroup', groupName, privilegeName\n  });\n  showLockedAlertReload({type: 'privilegeRemovedFromGroup'});\n}\n\n/** @type {string} */\nlet group;\n\n/** @type {import('../views/utilities/AlertDialog.js').JQueryWithModal} */\nlet deleteGroupConfirmDialog;\nGroupsView.getDeleteGroups().on('click', (e) => {\n  // eslint-disable-next-line prefer-destructuring -- TS\n  group = /** @type {string} */ (e.target.dataset.group);\n\n  // handle group deletion\n  deleteGroupConfirmDialog = GroupsView.setDeleteGroup(group);\n  ConfirmDialog.getSubmit(\n    deleteGroupConfirmDialog\n  ).on('click', async () => {\n    try {\n      await deleteGroup();\n    } catch (er) {\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n  deleteGroupConfirmDialog.modal('show');\n});\n\nconst removeUserFromGroupConfirmDialog = GroupsView.setRemoveUserFromGroup();\nGroupsView.getRemoveUserFromGroup().on('click', (e) => {\n  const groupName = /** @type {string} */ (e.target.dataset.group);\n  const userID = /** @type {string} */ (e.target.dataset.user);\n  ConfirmDialog.getSubmit(\n    removeUserFromGroupConfirmDialog\n  ).on('click', async () => {\n    try {\n      await removeUserFromGroup(groupName, userID);\n    } catch (er) {\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n  removeUserFromGroupConfirmDialog.modal('show');\n});\n\n/**\n * @param {string} url\n * @param {object} [data]\n * @returns {Promise<void>}\n */\nfunction post (url, data) {\n  /** @type {JQuery.AjaxSettings} */\n  const args = {\n    type: 'post',\n    headers: {\n      'X-XSRF-Token': xsrfCookie\n    }\n  };\n  if (data) {\n    args.data = data;\n  }\n\n  // eslint-disable-next-line promise/avoid-new -- our own API\n  return new Promise((resolve, reject) => {\n    $.ajax(url, args).done(resolve).fail(\n      (jqXHR /* , textStatus, errorThrown */) => {\n        const err = /** @type {AjaxPostError} */ (\n          new Error('Ajax POST error')\n        );\n        err.text = jqXHR.responseText;\n        err.responseText = jqXHR.statusText;\n        reject(err);\n      }\n    );\n  });\n  // Reenable after these related issues are fixed:\n  // https://github.com/cypress-io/cypress/issues/95\n  // https://github.com/cypress-io/cypress/issues/687\n  /*\n  const resp = await fetch(url, {\n    method: 'POST'\n  });\n  await checkErrors(resp);\n  */\n  /**\n   * @param {Response} resp\n   * @throws {Error}\n   * @returns {Promise<void>}\n   */\n  /*\n  async function checkErrors (resp) {\n    if (!resp.ok) {\n      const err = new Error();\n      err.text = await resp.text();\n      err.responseText = resp.statusText;\n      throw err;\n    }\n  }\n  */\n}\n\n/**\n * @throws {Error}\n * @param {string} groupName\n * @param {string} userID\n * @returns {Promise<void>}\n */\nasync function removeUserFromGroup (groupName, userID) {\n  removeUserFromGroupConfirmDialog.modal('hide');\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'removeUserFromGroup', groupName, userID\n  });\n  showLockedAlertReload({type: 'userRemovedFromGroup'});\n}\n\n/**\n * @param {string} groupToCreate\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function createGroup (groupToCreate) {\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'createGroup', groupName: groupToCreate\n  });\n  createGroupModal.modal('hide');\n  showLockedAlertReload({type: 'groupCreated'});\n}\n\n/**\n * @param {string} groupName\n * @param {string} newGroupName\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function renameGroup (groupName, newGroupName) {\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'renameGroup', groupName, newGroupName\n  });\n  renameGroupModal.modal('hide');\n  showLockedAlertReload({type: 'groupRenamed'});\n}\n\n/**\n * @param {string} groupName\n * @param {string} userID\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function addUserToGroup (groupName, userID) {\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'addUserToGroup', groupName, userID\n  });\n  addUserToGroupModal.modal('hide');\n  showLockedAlertReload({type: 'userAddedToGroup'});\n}\n\n/**\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function deleteGroup () {\n  deleteGroupConfirmDialog.modal('hide');\n  await post(Nogin.Routes.accessAPI, {verb: 'deleteGroup', groupName: group});\n  showLockedAlertReload({type: 'groupDeleted'});\n}\n\n/**\n * @param {object} cfg\n * @param {\"groupCreated\"|\"groupDeleted\"|\"groupRenamed\"|\n *   \"userRemovedFromGroup\"|\"userAddedToGroup\"|\"privilegeAddedToGroup\"|\n *   \"privilegeRemovedFromGroup\"} cfg.type\n * @returns {void}\n */\nfunction showLockedAlertReload ({type}) {\n  const lockedAlertDialog = GroupsView.onShowLockedAlert({\n    type,\n    group\n  });\n  lockedAlertDialog.modal('show');\n  const refresh = () => {\n    // @ts-expect-error Ok\n    location.reload(true);\n  };\n  GroupsView.getLockedAlertButton(\n    lockedAlertDialog\n  ).on('click', refresh);\n  setTimeout(refresh, 3000);\n}\n\n/**\n * @param {object} cfg\n * @param {\"ErrorLoggingOut\"|\"SessionLost\"|\"ProblemDispatchingLink\"|\n *   \"FailureSubmittingGroupInfo\"} [cfg.type]\n * @param {string} [cfg.message]\n * @returns {void}\n*/\nfunction showLockedErrorAlert ({type, message}) {\n  const lockedAlertDialog = GroupsView.onShowLockedErrorAlert({\n    type, message, group\n  });\n  lockedAlertDialog.modal('show');\n  const refresh = () => {\n    // @ts-expect-error Ok\n    location.reload(true);\n  };\n  GroupsView.getLockedAlertButton(\n    lockedAlertDialog\n  ).on('click', refresh);\n  setTimeout(refresh, 3000);\n}\n\n\n"],"names":["Error","window","_createClass","_classCallCheck","ConfirmDialog","populate","_ref","type","header","body","cancel","submit","baseSel","concat","$","modal","show","keyboard","backdrop","text","empty","append","on","getSubmit","confirmDialog","find","AlertDialog","heading","e","preventDefault","_","Nogin","lockedAlert","message","group","lb","throwOnExtraSuppliedFormatters","GroupsView","getLockedAlertButton","lockedAlertDialog","getDeleteGroups","getRemoveUserFromGroup","getAddPrivilegeToGroupButton","addPrivilegeToGroupModal","addPrivilegeToGroupForm","getAddPrivilegeToGroupGroup","addPrivilegeToGroupCancel","addPrivilegeToGroupSubmit","createGroupModal","renameGroupModal","addUserToGroupModal","createGroupForm","renameGroupForm","addUserToGroupForm","createGroupSubmit","addUserToGroupSubmit","renameGroupSubmit","createGroupCancel","addUserToGroupCancel","renameGroupCancel","getCreateGroupButton","getRenameGroupButton","getAddUserToGroupButton","getCreateGroupName","getAddUserToGroupName","getRenameGroupName","setDeleteGroup","deleteGroupConfirmDialog","addClass","setRemoveUserFromGroup","removeUserFromGroupConfirmDialog","getRemovePrivilegeFromGroup","setRemovePrivilegeFromGroup","removePrivilegeFromGroupConfirmDialog","onShowLockedAlert","_ref2","onShowLockedErrorAlert","_ref3","errorMessages","name","PleaseEnterName","_empty","deleteGroup","_async","_await","post","Routes","accessAPI","verb","groupName","showLockedAlertReload","_awaitIgnored","value","direct","then","Promise","resolve","addUserToGroup","userID","_catch","recover","result","renameGroup","newGroupName","f","args","i","arguments","length","apply","this","reject","createGroup","groupToCreate","_continueIgnored","removeUserFromGroup","removePrivilegeFromGroup","privilegeName","_callIgnored","_call","addPrivilegeToGroup","xsrfCookie","attr","createGroupButton","validity","tooShort","setCustomValidity","reportValidity","er","err","console","error","statusText","showLockedErrorAlert","renameGroupButton","target","dataset","groupToRename","addUserToGroupButton","userToAdd","addPrivilegeToGroupButton","privilegeToAdd","privilegeID","privilege","url","data","headers","ajax","done","fail","jqXHR","responseText","refresh","location","reload","setTimeout","user"],"mappings":"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"}