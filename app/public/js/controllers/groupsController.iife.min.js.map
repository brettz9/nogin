{"version":3,"file":"groupsController.iife.min.js","sources":["../polyfills/Error.js","../views/utilities/ConfirmDialog.js","../views/utilities/AlertDialog.js","../views/groups.js","groupsController.js"],"sourcesContent":["/* eslint-disable no-restricted-globals, no-shadow -- Polyfill */\n// For IE 5.5 (needed per `eslint-plugin-compat`)\nif (typeof Error === 'undefined') {\n  /**\n   * Error polyfill.\n   */\n  // @ts-expect-error Ok for browser\n  window.Error = class Error {};\n}\n","/* globals $ -- `$` is jQuery not ESM */\n\nconst ConfirmDialog = {\n  /**\n   * @param {{\n   *   type: string,\n   *   header: string,\n   *   body: string|Element,\n   *   cancel: string,\n   *   submit: string\n   * }} cfg\n   * @returns {import('./AlertDialog.js').JQueryWithModal}\n   */\n  populate ({\n    type,\n    header,\n    body,\n    cancel,\n    submit\n  }) {\n    const baseSel = `[data-confirm-type=\"${type}\"][data-name=modal-confirm]`;\n    /** @type {import('./AlertDialog.js').JQueryWithModal} */ (\n      $(baseSel)).modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    $(`${baseSel} .modal-header [data-name=modal-title]`).text(\n      header\n    );\n    $(`${baseSel} [data-name=modal-body] p`).empty().append(\n      body\n    );\n    $(`${baseSel} .cancel`).text(cancel).on('click', () => {\n      /** @type {import('./AlertDialog.js').JQueryWithModal} */ (\n        $(baseSel)\n      ).modal('hide');\n    });\n    $(`${baseSel} .submit`).text(submit);\n    return /** @type {import('./AlertDialog.js').JQueryWithModal} */ (\n      $(baseSel)\n    );\n  },\n\n  /**\n   * @param {JQuery} confirmDialog\n   * @returns {JQuery}\n   */\n  getSubmit (confirmDialog) {\n    return confirmDialog.find('.submit');\n  }\n};\n\nexport default ConfirmDialog;\n","/* globals $ -- `$` is jQuery not ESM */\n\n/**\n * @typedef {JQuery & {\n *   modal: (showOrHide: \"show\"|\"hide\"|{\n *     show: boolean,\n *     keyboard: boolean,\n *     backdrop: boolean|\"static\"\n *   }) => JQueryWithModal\n * }} JQueryWithModal\n */\n\nconst AlertDialog = {\n  /**\n   * @param {object} cfg\n   * @param {string} cfg.heading\n   * @param {Element|string} cfg.body\n   * @param {boolean} cfg.keyboard\n   * @param {boolean|\"static\"} cfg.backdrop\n   * @returns {JQueryWithModal} `HTMLDivElement`\n   */\n  populate ({\n    heading,\n    body,\n    keyboard,\n    backdrop\n  }) {\n    const modal = /** @type {JQueryWithModal} */ (\n      $('[data-name=modal-alert]')).modal({\n      show: false, keyboard, backdrop\n    });\n    $('[data-name=modal-alert] .modal-header [data-name=modal-title]').text(\n      heading\n    );\n    $('[data-name=modal-alert] [data-name=modal-body] p').empty().append(body);\n    $('[data-name=modal-alert] button').on('click', (e) => {\n      e.preventDefault();\n      modal.modal('hide');\n    });\n    return modal;\n  }\n};\n\nexport default AlertDialog;\n","/* globals $, Nogin -- `$` is jQuery not ESM, `Nogin` is server-set */\n\nimport ConfirmDialog from './utilities/ConfirmDialog.js';\nimport AlertDialog from './utilities/AlertDialog.js';\n\nconst {_} = Nogin;\n\n/**\n * @param {object} cfg\n * @param {string} [cfg.type]\n * @param {string} [cfg.message]\n * @param {string} [cfg.group]\n * @param {\"error\"|\"success\"} cfg.heading\n * @returns {import('./utilities/AlertDialog.js').\n *   JQueryWithModal} `HTMLDivElement`\n */\nfunction lockedAlert ({type, message, group, heading}) {\n  return AlertDialog.populate({\n    heading: /** @type {string} */ (_(heading)),\n    body: message || _(\n      /** @type {string} */ (type),\n      group\n        ? {lb: $('<br/>')[0], group}\n        : {},\n      {\n        // We're accepting a variety of messages here so no big deal\n        //   if missing a line break (e.g., some even with `group`)\n        throwOnExtraSuppliedFormatters: false\n      }\n    ),\n    keyboard: false,\n    backdrop: 'static'\n  });\n}\n\nconst GroupsView = {\n  /**\n   * @param {JQuery} lockedAlertDialog\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  getLockedAlertButton (lockedAlertDialog) {\n    return lockedAlertDialog.find('button');\n  },\n\n  /**\n   * @returns {JQuery<HTMLElement>}\n   */\n  getDeleteGroups () {\n    return $('button.deleteGroup');\n  },\n\n  /**\n   * @returns {JQuery<HTMLElement>}\n   */\n  getRemoveUserFromGroup () {\n    return $('button.removeUserFromGroup');\n  },\n\n  /**\n   * @returns {import('../views/utilities/AlertDialog.js').\n  *   JQueryWithModal} `HTMLDivElement`\n  */\n  createGroupModal () {\n    const createGroupModal =\n      /**\n      * @type {import('../views/utilities/AlertDialog.js').\n      *   JQueryWithModal}\n      */ (\n        $('#createGroup')\n      );\n    createGroupModal.modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    return createGroupModal;\n  },\n\n  /**\n   * @returns {import('../views/utilities/AlertDialog.js').\n  *   JQueryWithModal} `HTMLDivElement`\n  */\n  renameGroupModal () {\n    const renameGroupModal =\n      /**\n      * @type {import('../views/utilities/AlertDialog.js').\n      *   JQueryWithModal}\n      */ (\n        $('#renameGroup')\n      );\n    renameGroupModal.modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    return renameGroupModal;\n  },\n\n  /**\n   * @returns {import('../views/utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  addUserToGroupModal () {\n    const addUserToGroupModal =\n      /**\n      * @type {import('../views/utilities/AlertDialog.js').\n      *   JQueryWithModal}\n      */ (\n        $('#addUserToGroup')\n      );\n    addUserToGroupModal.modal({\n      show: false, keyboard: true, backdrop: true\n    });\n    return addUserToGroupModal;\n  },\n\n  /**\n   * @param {JQuery} createGroupModal `HTMLDivElement`\n   * @returns {import('../utilities/ajaxFormClientSideValidate.js').\n   *   JQueryWithAjaxForm} `HTMLFormElement`\n   */\n  createGroupForm (createGroupModal) {\n    return (\n      /**\n       * @type {import('../utilities/ajaxFormClientSideValidate.js').\n       * JQueryWithAjaxForm}\n       */\n      (createGroupModal.find('#createGroup-form'))\n    );\n  },\n\n  /**\n   * @param {JQuery} renameGroupModal `HTMLDivElement`\n   * @returns {import('../utilities/ajaxFormClientSideValidate.js').\n  *   JQueryWithAjaxForm} `HTMLFormElement`\n  */\n  renameGroupForm (renameGroupModal) {\n    return (\n      /**\n      * @type {import('../utilities/ajaxFormClientSideValidate.js').\n      * JQueryWithAjaxForm}\n      */\n      (renameGroupModal.find('#renameGroup-form'))\n    );\n  },\n\n  /**\n   * @param {JQuery} addUserToGroupModal `HTMLDivElement`\n   * @returns {import('../utilities/ajaxFormClientSideValidate.js').\n   *   JQueryWithAjaxForm} `HTMLFormElement`\n   */\n  addUserToGroupForm (addUserToGroupModal) {\n    return (\n      /**\n      * @type {import('../utilities/ajaxFormClientSideValidate.js').\n      * JQueryWithAjaxForm}\n      */\n      (addUserToGroupModal.find('#addUserToGroup-form'))\n    );\n  },\n\n  /**\n   * @param {JQuery} createGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  createGroupSubmit (createGroupModal) {\n    return createGroupModal.find('[data-name=createGroup-submit]');\n  },\n\n  /**\n   * @param {JQuery} addUserToGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  addUserToGroupSubmit (addUserToGroupModal) {\n    return addUserToGroupModal.find('[data-name=addUserToGroup-submit]');\n  },\n\n  /**\n   * @param {JQuery} renameGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  renameGroupSubmit (renameGroupModal) {\n    return renameGroupModal.find('[data-name=renameGroup-submit]');\n  },\n\n  /**\n   * @param {JQuery} createGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  createGroupCancel (createGroupModal) {\n    return createGroupModal.find('[data-name=createGroup-cancel]');\n  },\n\n  /**\n   * @param {JQuery} addUserToGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  addUserToGroupCancel (addUserToGroupModal) {\n    return addUserToGroupModal.find('[data-name=addUserToGroup-cancel]');\n  },\n\n  /**\n   * @param {JQuery} renameGroupModal `HTMLDivElement`\n   * @returns {JQuery} `HTMLButtonElement`\n   */\n  renameGroupCancel (renameGroupModal) {\n    return renameGroupModal.find('[data-name=renameGroup-cancel]');\n  },\n\n  /**\n   * @returns {JQuery} `HTMLDivElement`\n   */\n  getCreateGroupButton () {\n    return $('button.createGroup');\n  },\n\n  /**\n   * @returns {JQuery} `HTMLDivElement`\n   */\n  getRenameGroupButton () {\n    return $('button.renameGroup');\n  },\n\n  /**\n   * @returns {JQuery} `HTMLDivElement`\n   */\n  getAddUserToGroupButton () {\n    return $('button.addUserToGroup');\n  },\n\n  /**\n   * @returns {HTMLInputElement}\n   */\n  getCreateGroupName () {\n    return /** @type {HTMLInputElement} */ ($('#createGroup-input')[0]);\n  },\n\n  /**\n   * @returns {HTMLInputElement}\n   */\n  getAddUserToGroupName () {\n    return /** @type {HTMLInputElement} */ ($('#addUserToGroup-input')[0]);\n  },\n\n  /**\n   * @returns {HTMLInputElement}\n   */\n  getRenameGroupName () {\n    return /** @type {HTMLInputElement} */ ($('#renameGroup-input')[0]);\n  },\n\n  /**\n   * @param {string} group\n   * @returns {import('./utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  setDeleteGroup (group) {\n    const deleteGroupConfirmDialog = ConfirmDialog.populate({\n      type: 'deleteGroup',\n      header: /** @type {string} */ (_('deleteGroup')),\n      body: /** @type {string} */ (_('sureWantDeleteGroup', {\n        group\n      })),\n      cancel: /** @type {string} */ (_('cancel')),\n      submit: /** @type {string} */ (_('delete'))\n    });\n    deleteGroupConfirmDialog.find('.submit').addClass('btn-danger');\n    return /** @type {import('./utilities/AlertDialog.js').JQueryWithModal} */ (\n      deleteGroupConfirmDialog\n    );\n  },\n\n  /**\n   * @returns {import('./utilities/AlertDialog.js').\n  *   JQueryWithModal} `HTMLDivElement`\n  */\n  setRemoveUserFromGroup () {\n    const removeUserFromGroupConfirmDialog = ConfirmDialog.populate({\n      type: 'deleteGroup',\n      header: /** @type {string} */ (_('removeUserFromGroup')),\n      body: /** @type {string} */ (_('reallyWantRemoveUserFromGroup')),\n      cancel: /** @type {string} */ (_('cancel')),\n      submit: /** @type {string} */ (_('delete'))\n    });\n    removeUserFromGroupConfirmDialog.find('.submit').addClass('btn-danger');\n    return /** @type {import('./utilities/AlertDialog.js').JQueryWithModal} */ (\n      removeUserFromGroupConfirmDialog\n    );\n  },\n\n  /**\n   * @param {object} cfg\n   * @param {\"groupCreated\"|\"groupDeleted\"|\"groupRenamed\"|\n   *   \"userRemovedFromGroup\"|\"userAddedToGroup\"} cfg.type\n   * @param {string} [cfg.group]\n   * @returns {import('./utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  onShowLockedAlert ({type, group}) {\n    return lockedAlert({type, group, heading: 'success'});\n  },\n\n  /**\n   * @param {object} cfg\n   * @param {string} cfg.group\n   * @param {string} [cfg.message]\n   * @param {\"ErrorLoggingOut\"|\"FailureSubmittingGroupInfo\"|\n   * \"SessionLost\"|\"ProblemDispatchingLink\"} [cfg.type]\n   * @returns {import('./utilities/AlertDialog.js').\n   *   JQueryWithModal} `HTMLDivElement`\n   */\n  onShowLockedErrorAlert ({type, group, message}) {\n    return lockedAlert({type, message, group, heading: 'error'});\n  },\n\n  /**\n   * @type {{[key: string]: {[key: string]: string}}}\n   */\n  errorMessages: {\n    name: {\n      PleaseEnterName: /** @type {string} */ (_('PleaseEnterName'))\n    }\n  }\n};\n\nexport default GroupsView;\n","/* globals $, Nogin -- `$` is jQuery not ESM, `Nogin` is server-set */\n\nimport '../polyfills/Error.js';\nimport '../polyfills/console.js';\n\nimport ConfirmDialog from '../views/utilities/ConfirmDialog.js';\nimport GroupsView from '../views/groups.js';\n\n/**\n * @typedef {Error & {\n *   text: string,\n *   responseText: string,\n *   statusText?: string\n * }} AjaxPostError\n */\n\nconst xsrfCookie = $('meta[name=\"csrf-token\"]').attr('content');\n\nconst createGroupButton = GroupsView.getCreateGroupButton();\nconst createGroupModal = GroupsView.createGroupModal();\nconst createGroupForm = GroupsView.createGroupForm(\n  createGroupModal\n);\n\ncreateGroupForm.on('submit', function (e) {\n  e.preventDefault();\n});\ncreateGroupButton.on('click', () => {\n  const createGroupCancel = GroupsView.createGroupCancel(\n    createGroupModal\n  );\n\n  createGroupCancel.on('click', () => {\n    createGroupModal.modal('hide');\n  });\n  createGroupModal.modal('show');\n\n  const createGroupSubmit = GroupsView.createGroupSubmit(\n    createGroupModal\n  );\n  createGroupSubmit.on('click', async () => {\n    try {\n      const groupToCreate = GroupsView.getCreateGroupName();\n      if (groupToCreate.validity.tooShort) {\n        groupToCreate.setCustomValidity(\n          GroupsView.errorMessages.name.PleaseEnterName\n        );\n        /** @type {HTMLFormElement} */ (createGroupForm[0]).reportValidity();\n        return;\n      }\n      await createGroup(groupToCreate.value);\n    } catch (er) {\n      createGroupModal.modal('hide');\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n});\n\nconst renameGroupButton = GroupsView.getRenameGroupButton();\nconst renameGroupModal = GroupsView.renameGroupModal();\nconst renameGroupForm = GroupsView.renameGroupForm(\n  renameGroupModal\n);\n\nrenameGroupForm.on('submit', function (e) {\n  e.preventDefault();\n});\nrenameGroupButton.on('click', (e) => {\n  const groupName = /** @type {string} */ (e.target.dataset.group);\n  const groupToRename = GroupsView.getRenameGroupName();\n\n  const renameGroupCancel = GroupsView.renameGroupCancel(\n    renameGroupModal\n  );\n\n  renameGroupCancel.on('click', () => {\n    renameGroupModal.modal('hide');\n  });\n  renameGroupModal.modal('show');\n  groupToRename.value = groupName;\n\n  const renameGroupSubmit = GroupsView.renameGroupSubmit(\n    renameGroupModal\n  );\n  renameGroupSubmit.on('click', async () => {\n    try {\n      if (groupToRename.validity.tooShort) {\n        groupToRename.setCustomValidity(\n          GroupsView.errorMessages.name.PleaseEnterName\n        );\n        /** @type {HTMLFormElement} */ (renameGroupForm[0]).reportValidity();\n        return;\n      }\n      const newGroupName = groupToRename.value;\n      await renameGroup(groupName, newGroupName);\n    } catch (er) {\n      renameGroupModal.modal('hide');\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n});\n\n// Todo: 'addUserToGroup'\nconst addUserToGroupButton = GroupsView.getAddUserToGroupButton();\nconst addUserToGroupModal = GroupsView.addUserToGroupModal();\nconst addUserToGroupForm = GroupsView.addUserToGroupForm(\n  addUserToGroupModal\n);\n\naddUserToGroupForm.on('submit', function (e) {\n  e.preventDefault();\n});\naddUserToGroupButton.on('click', (e) => {\n  const groupName = /** @type {string} */ (e.target.dataset.group);\n  const userToAdd = GroupsView.getAddUserToGroupName();\n\n  const addUserToGroupCancel = GroupsView.addUserToGroupCancel(\n    addUserToGroupModal\n  );\n\n  addUserToGroupCancel.on('click', () => {\n    addUserToGroupModal.modal('hide');\n  });\n  addUserToGroupModal.modal('show');\n\n  const addUserToGroupSubmit = GroupsView.addUserToGroupSubmit(\n    addUserToGroupModal\n  );\n  addUserToGroupSubmit.on('click', async () => {\n    try {\n      if (userToAdd.validity.tooShort) {\n        userToAdd.setCustomValidity(\n          GroupsView.errorMessages.name.PleaseEnterName\n        );\n        /** @type {HTMLFormElement} */ (addUserToGroupForm[0]).reportValidity();\n        return;\n      }\n      const userID = userToAdd.value;\n      await addUserToGroup(groupName, userID);\n    } catch (er) {\n      addUserToGroupModal.modal('hide');\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n});\n\n/** @type {string} */\nlet group;\n\n/** @type {import('../views/utilities/AlertDialog.js').JQueryWithModal} */\nlet deleteGroupConfirmDialog;\nGroupsView.getDeleteGroups().on('click', (e) => {\n  // eslint-disable-next-line prefer-destructuring -- TS\n  group = /** @type {string} */ (e.target.dataset.group);\n\n  // handle group deletion\n  deleteGroupConfirmDialog = GroupsView.setDeleteGroup(group);\n  ConfirmDialog.getSubmit(\n    deleteGroupConfirmDialog\n  ).on('click', async () => {\n    try {\n      await deleteGroup();\n    } catch (er) {\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n  deleteGroupConfirmDialog.modal('show');\n});\n\nconst removeUserFromGroupConfirmDialog = GroupsView.setRemoveUserFromGroup();\nGroupsView.getRemoveUserFromGroup().on('click', (e) => {\n  const groupName = /** @type {string} */ (e.target.dataset.group);\n  const userID = /** @type {string} */ (e.target.dataset.user);\n  ConfirmDialog.getSubmit(\n    removeUserFromGroupConfirmDialog\n  ).on('click', async () => {\n    try {\n      await removeUserFromGroup(groupName, userID);\n    } catch (er) {\n      const err = /** @type {AjaxPostError} */ (er);\n\n      // Log just in case not internationalized\n      console.error(Nogin._('ErrorFormat', {\n        text: err.text,\n        statusText:\n          // istanbul ignore next\n          err.statusText ||\n          ''\n      }));\n      // However, should already be internationalized by server\n      showLockedErrorAlert({message: err.text});\n    }\n  });\n  removeUserFromGroupConfirmDialog.modal('show');\n});\n\n/**\n * @param {string} url\n * @param {object} [data]\n * @returns {Promise<void>}\n */\nfunction post (url, data) {\n  /** @type {JQuery.AjaxSettings} */\n  const args = {\n    type: 'post',\n    headers: {\n      'X-XSRF-Token': xsrfCookie\n    }\n  };\n  if (data) {\n    args.data = data;\n  }\n\n  // eslint-disable-next-line promise/avoid-new -- our own API\n  return new Promise((resolve, reject) => {\n    $.ajax(url, args).done(resolve).fail(\n      (jqXHR /* , textStatus, errorThrown */) => {\n        const err = /** @type {AjaxPostError} */ (\n          new Error('Ajax POST error')\n        );\n        err.text = jqXHR.responseText;\n        err.responseText = jqXHR.statusText;\n        reject(err);\n      }\n    );\n  });\n  // Reenable after these related issues are fixed:\n  // https://github.com/cypress-io/cypress/issues/95\n  // https://github.com/cypress-io/cypress/issues/687\n  /*\n  const resp = await fetch(url, {\n    method: 'POST'\n  });\n  await checkErrors(resp);\n  */\n  /**\n   * @param {Response} resp\n   * @throws {Error}\n   * @returns {Promise<void>}\n   */\n  /*\n  async function checkErrors (resp) {\n    if (!resp.ok) {\n      const err = new Error();\n      err.text = await resp.text();\n      err.responseText = resp.statusText;\n      throw err;\n    }\n  }\n  */\n}\n\n/**\n * @throws {Error}\n * @param {string} groupName\n * @param {string} userID\n * @returns {Promise<void>}\n */\nasync function removeUserFromGroup (groupName, userID) {\n  removeUserFromGroupConfirmDialog.modal('hide');\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'removeUserFromGroup', groupName, userID\n  });\n  showLockedAlertReload({type: 'userRemovedFromGroup'});\n}\n\n/**\n * @param {string} groupToCreate\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function createGroup (groupToCreate) {\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'createGroup', groupName: groupToCreate\n  });\n  createGroupModal.modal('hide');\n  showLockedAlertReload({type: 'groupCreated'});\n}\n\n/**\n * @param {string} groupName\n * @param {string} newGroupName\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function renameGroup (groupName, newGroupName) {\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'renameGroup', groupName, newGroupName\n  });\n  renameGroupModal.modal('hide');\n  showLockedAlertReload({type: 'groupRenamed'});\n}\n\n/**\n * @param {string} groupName\n * @param {string} userID\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function addUserToGroup (groupName, userID) {\n  await post(Nogin.Routes.accessAPI, {\n    verb: 'addUserToGroup', groupName, userID\n  });\n  addUserToGroupModal.modal('hide');\n  showLockedAlertReload({type: 'userAddedToGroup'});\n}\n\n/**\n * @throws {Error}\n * @returns {Promise<void>}\n */\nasync function deleteGroup () {\n  deleteGroupConfirmDialog.modal('hide');\n  await post(Nogin.Routes.accessAPI, {verb: 'deleteGroup', groupName: group});\n  showLockedAlertReload({type: 'groupDeleted'});\n}\n\n/**\n * @param {object} cfg\n * @param {\"groupCreated\"|\"groupDeleted\"|\"groupRenamed\"|\n *   \"userRemovedFromGroup\"|\"userAddedToGroup\"} cfg.type\n * @returns {void}\n */\nfunction showLockedAlertReload ({type}) {\n  const lockedAlertDialog = GroupsView.onShowLockedAlert({\n    type,\n    group\n  });\n  lockedAlertDialog.modal('show');\n  const refresh = () => {\n    // @ts-expect-error Ok\n    location.reload(true);\n  };\n  GroupsView.getLockedAlertButton(\n    lockedAlertDialog\n  ).on('click', refresh);\n  setTimeout(refresh, 3000);\n}\n\n/**\n * @param {object} cfg\n * @param {\"ErrorLoggingOut\"|\"SessionLost\"|\"ProblemDispatchingLink\"|\n *   \"FailureSubmittingGroupInfo\"} [cfg.type]\n * @param {string} [cfg.message]\n * @returns {void}\n*/\nfunction showLockedErrorAlert ({type, message}) {\n  const lockedAlertDialog = GroupsView.onShowLockedErrorAlert({\n    type, message, group\n  });\n  lockedAlertDialog.modal('show');\n  const refresh = () => {\n    // @ts-expect-error Ok\n    location.reload(true);\n  };\n  GroupsView.getLockedAlertButton(\n    lockedAlertDialog\n  ).on('click', refresh);\n  setTimeout(refresh, 3000);\n}\n\n\n"],"names":["Error","window","_createClass","_classCallCheck","ConfirmDialog","populate","_ref","type","header","body","cancel","submit","baseSel","concat","$","modal","show","keyboard","backdrop","text","empty","append","on","getSubmit","confirmDialog","find","AlertDialog","heading","e","preventDefault","_","Nogin","lockedAlert","message","group","lb","throwOnExtraSuppliedFormatters","GroupsView","getLockedAlertButton","lockedAlertDialog","getDeleteGroups","getRemoveUserFromGroup","createGroupModal","renameGroupModal","addUserToGroupModal","createGroupForm","renameGroupForm","addUserToGroupForm","createGroupSubmit","addUserToGroupSubmit","renameGroupSubmit","createGroupCancel","addUserToGroupCancel","renameGroupCancel","getCreateGroupButton","getRenameGroupButton","getAddUserToGroupButton","getCreateGroupName","getAddUserToGroupName","getRenameGroupName","setDeleteGroup","deleteGroupConfirmDialog","addClass","setRemoveUserFromGroup","removeUserFromGroupConfirmDialog","onShowLockedAlert","_ref2","onShowLockedErrorAlert","_ref3","errorMessages","name","PleaseEnterName","_empty","deleteGroup","_async","_await","post","Routes","accessAPI","verb","groupName","showLockedAlertReload","_awaitIgnored","value","direct","then","Promise","resolve","addUserToGroup","userID","_catch","recover","result","renameGroup","newGroupName","f","args","i","arguments","length","apply","this","reject","createGroup","groupToCreate","removeUserFromGroup","_callIgnored","_call","xsrfCookie","attr","_continueIgnored","createGroupButton","validity","tooShort","setCustomValidity","reportValidity","er","err","console","error","statusText","showLockedErrorAlert","renameGroupButton","target","dataset","groupToRename","addUserToGroupButton","userToAdd","url","data","headers","ajax","done","fail","jqXHR","responseText","refresh","location","reload","setTimeout","user"],"mappings":"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"}