!function(){"use strict";function e(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function a(e,a){for(var t=0;t<a.length;t++){var s=a[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var t={getForm:function(){return $("[data-name=account-form]")[0]},getUserId:function(){return $("#userId")},getFormFields:function(){return{name:$('[data-name="name"]')[0],email:$('[data-name="email"]')[0],user:$('[data-name="user"]')[0],pass:$('[data-name="pass"]')[0],passConfirm:$('[data-name="pass-confirm"]')&&$('[data-name="pass-confirm"]')[0]}},errorMessages:{name:{PleaseEnterName:_("PleaseEnterName")},email:{emailAddressAlreadyInUse:_("emailAddressAlreadyInUse"),PleaseEnterValidEmail:_("PleaseEnterValidEmail")},user:{userNameAlreadyInUse:_("userNameAlreadyInUse"),PleaseChooseUserName:_("PleaseChooseUserName")},pass:{PasswordMinimumLength:_("PasswordMinimumLength"),PasswordsDontMatch:_("PasswordsDontMatch")}}},s=function(){function s(){var a=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.signup;e(this,s),this.signup=i,this.form=t.getForm(),this.formFields=t.getFormFields(),this.userId=t.getUserId(),this.errorMessages=t.errorMessages,this.userIsLoggedIn=function(e){return a.userId.val()&&""===e}}var r,i,n;return r=s,(i=[{key:"showInvalidEmail",value:function(){this.formFields.email.setCustomValidity(this.errorMessages.email.emailAddressAlreadyInUse),this.form.reportValidity()}},{key:"showInvalidUserName",value:function(){this.formFields.user.setCustomValidity(this.errorMessages.user.userNameAlreadyInUse),this.form.reportValidity()}},{key:"validateForm",value:function(){var e=this.formFields,a=e.name,t=e.email,s=e.user,r=e.pass,i=e.passConfirm;return Object.values(this.formFields).forEach((function(e){e&&e.setCustomValidity("")})),a.validity.tooShort&&a.setCustomValidity(this.errorMessages.name.PleaseEnterName),t.validity.patternMismatch&&t.setCustomValidity(this.errorMessages.email.PleaseEnterValidEmail),s.validity.tooShort&&s.setCustomValidity(this.errorMessages.user.PleaseChooseUserName),!this.userIsLoggedIn()&&r.validity.tooShort&&r.setCustomValidity(this.errorMessages.pass.PasswordMinimumLength),this.signup&&r.value!==i.value&&r.setCustomValidity(this.errorMessages.pass.PasswordsDontMatch),this.form.reportValidity()}}])&&a(r.prototype,i),n&&a(r,n),s}(),r=function(e){var a=e.heading,t=e.body,s=e.keyboard,r=e.backdrop;return $("[data-name=modal-alert]").modal({show:!1,keyboard:s,backdrop:r}),$("[data-name=modal-alert] .modal-header [data-name=modal-title]").text(a),$("[data-name=modal-alert] [data-name=modal-body] p").empty().append(t),$("[data-name=modal-alert]")},i=function(e){return e.find("[data-name=ok]")},n=function(e){return e.find("[data-name=action1]")},o=function(){var e,a,t,s,r,i;return e="[data-name=account-form]",a={heading:_("Signup"),subheading:_("PleaseTellUsAboutYourself"),action1:_("Cancel"),action2:_("Submit")},t=a.heading,s=a.subheading,r=a.action1,i=a.action2,$(e+" h1.dialog").text(t),$(e+" h2.dialog").text(s),$(e+" [data-name=action1]").text(r),$(e+" [data-name=action2]").text(i),$(e)},d=function(){return r({heading:_("AccountCreatedSignup"),body:_("PleaseCheckEmailForVerificationLink",{lb:$("<br/>")[0]}),keyboard:!1,backdrop:"static"})},l=function(e){var a=e.type;return r({heading:_("error"),body:_(a,{lb:$("<br/>")[0]}),keyboard:!1,backdrop:"static"})};(function(){return $("#name-tf")})().focus();var m,u,c,h,f,g,y,p,v=o(),b=function(){location.href=NL_ROUTES.root};n(v).click(b),m=new s({signup:!0}),u=v,h=(c={validate:function(){m.validateForm()},success:function(e,a,t,s){var r;"success"===a&&(r=d(),i(r).click((function(){setTimeout(b,300)})),r.modal("show"))},error:function(e){switch(e.responseText){case"email-taken":m.showInvalidEmail();break;case"username-taken":m.showInvalidUserName();break;default:l({type:"DispatchActivationLinkError"}).modal("show")}}}).validate,f=c.url,g=c.beforeSubmit,y=c.success,p=c.error,u[0].addEventListener("change",(function(e){h(e)}),!0),u[0].addEventListener("input",(function(e){var a=e.target;a.setCustomValidity(""),a.checkValidity("")}),!0),u.ajaxForm({url:f,beforeSubmit:g,success:y,error:p})}();
//# sourceMappingURL=signupController.iife.min.js.map
