!function(){"use strict";var e=$('meta[name="csrf-token"]').attr("content");function a(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function t(e,a){for(var t=0;t<a.length;t++){var s=a[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var s=Nogin._,r={getForm:function(){return $("[data-name=account-form]")[0]},getUserId:function(){return $("#userId")},getFormFields:function(){return{name:$('[data-name="name"]')[0],email:$('[data-name="email"]')[0],user:$('[data-name="user"]')[0],pass:$('[data-name="pass"]')[0],passConfirm:$('[data-name="pass-confirm"]')&&$('[data-name="pass-confirm"]')[0]}},errorMessages:{name:{PleaseEnterName:s("PleaseEnterName")},email:{emailAddressAlreadyInUse:s("emailAddressAlreadyInUse"),PleaseEnterValidEmail:s("PleaseEnterValidEmail")},user:{userNameAlreadyInUse:s("userNameAlreadyInUse"),PleaseChooseUserName:s("PleaseChooseUserName")},pass:{PasswordMinimumLength:s("PasswordMinimumLength"),PasswordsDontMatch:s("PasswordsDontMatch")}}},n=function(){function e(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=s.signup;a(this,e),this.signup=n,this.form=r.getForm(),this.formFields=r.getFormFields(),this.userId=r.getUserId(),this.errorMessages=r.errorMessages,this.userIsLoggedIn=function(e){return t.userId.val()&&""===e}}var s,n,i;return s=e,(n=[{key:"showInvalidEmail",value:function(){this.formFields.email.setCustomValidity(this.errorMessages.email.emailAddressAlreadyInUse),this.form.reportValidity()}},{key:"showInvalidUserName",value:function(){this.formFields.user.setCustomValidity(this.errorMessages.user.userNameAlreadyInUse),this.form.reportValidity()}},{key:"validateForm",value:function(){var e=this.formFields,a=e.name,t=e.email,s=e.user,r=e.pass,n=e.passConfirm;return Object.values(this.formFields).forEach((function(e){e&&e.setCustomValidity("")})),a.validity.tooShort&&a.setCustomValidity(this.errorMessages.name.PleaseEnterName),t.validity.patternMismatch&&t.setCustomValidity(this.errorMessages.email.PleaseEnterValidEmail),s.validity.tooShort&&s.setCustomValidity(this.errorMessages.user.PleaseChooseUserName),!this.userIsLoggedIn()&&r.validity.tooShort&&r.setCustomValidity(this.errorMessages.pass.PasswordMinimumLength),this.signup&&r.value!==n.value&&r.setCustomValidity(this.errorMessages.pass.PasswordsDontMatch),this.form.reportValidity()}}])&&t(s.prototype,n),i&&t(s,i),e}(),i=function(e){var a=e.heading,t=e.body,s=e.keyboard,r=e.backdrop,n=$("[data-name=modal-alert]").modal({show:!1,keyboard:s,backdrop:r});return $("[data-name=modal-alert] .modal-header [data-name=modal-title]").text(a),$("[data-name=modal-alert] [data-name=modal-body] p").empty().append(t),$("[data-name=modal-alert] button").click((function(e){e.preventDefault(),n.modal("hide")})),n},o=Nogin._,d=function(e){return e.find("[data-name=ok]")},l=function(e){return e.find("[data-name=action1]")},m=function(){var e,a,t,s,r,n;return e="[data-name=account-form]",a={heading:o("Signup"),subheading:o("PleaseTellUsAboutYourself"),action1:o("Cancel"),action2:o("Submit")},t=a.heading,s=a.subheading,r=a.action1,n=a.action2,$(e+" h1.dialog").text(t),$(e+" h2.dialog").text(s),$(e+" [data-name=action1]").text(r),$(e+" [data-name=action2]").text(n),$(e)},u=function(){return i({heading:o("AccountCreatedSignup"),body:o("PleaseCheckEmailForVerificationLink",{lb:$("<br/>")[0]}),keyboard:!1,backdrop:"static"})},c=function(e){var a=e.type;return i({heading:o("error"),body:o(a,{lb:$("<br/>")[0]}),keyboard:!1,backdrop:"static"})};(function(){return $("#name-tf")})().focus();var h,f,g,y,p,v,b,k,w,F,I=m(),C=function(){Nogin.redirect("root")};l(I).click(C),h=new n({signup:!0}),f=I,y=(g={checkXSRF:!1,validate:function(){h.validateForm()},success:function(e,a,t,s){var r;"success"===a&&(r=u(),d(r).click((function(){setTimeout(C,3e3)})),r.modal("show"))},error:function(e){switch(e.responseText){case"email-taken":h.showInvalidEmail();break;case"username-taken":h.showInvalidUserName();break;default:c({type:"DispatchActivationLinkError"}).modal("show")}}}).validate,p=g.url,v=g.beforeSubmit,b=g.success,k=g.error,w=g.checkXSRF,F=void 0===w||w,f[0].addEventListener("change",(function(e){y(e)}),!0),f[0].addEventListener("input",(function(e){var a=e.target;a.setCustomValidity(""),a.checkValidity("")}),!0),!F||e||Nogin.disableXSRF?f.ajaxForm({headers:{"X-XSRF-Token":e},url:p,beforeSubmit:v,success:b,error:k}):k({responseText:"UnknownError"})}();
//# sourceMappingURL=signupController.iife.min.js.map
