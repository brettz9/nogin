!function(){"use strict";var e=$('meta[name="csrf-token"]').attr("content");function a(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function t(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(s=r.key,i=void 0,"symbol"==typeof(i=function(e,a){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,a||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(s,"string"))?i:String(i)),r)}var s,i}var r=Nogin._,s={getForm:function(){return $("[data-name=account-form]")[0]},getUserId:function(){return $("#userId")},getFormFields:function(){return{name:$('[data-name="name"]')[0],email:$('[data-name="email"]')[0],user:$('[data-name="user"]')[0],pass:$('[data-name="pass"]')[0],passConfirm:$('[data-name="pass-confirm"]')&&$('[data-name="pass-confirm"]')[0]}},errorMessages:{name:{PleaseEnterName:r("PleaseEnterName")},email:{emailAddressAlreadyInUse:r("emailAddressAlreadyInUse"),PleaseEnterValidEmail:r("PleaseEnterValidEmail")},user:{userNameAlreadyInUse:r("userNameAlreadyInUse"),PleaseChooseUserName:r("PleaseChooseUserName")},pass:{PasswordMinimumLength:r("PasswordMinimumLength"),PasswordsDontMatch:r("PasswordsDontMatch")}}},i=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.signup;a(this,e),this.signup=i,this.form=s.getForm(),this.formFields=s.getFormFields(),this.userId=s.getUserId(),this.errorMessages=s.errorMessages,this.userIsLoggedIn=function(e){return t.userId.val()&&""===e}}var r,i,n;return r=e,i=[{key:"showInvalidEmail",value:function(){this.formFields.email.setCustomValidity(this.errorMessages.email.emailAddressAlreadyInUse),this.form.reportValidity()}},{key:"showInvalidUserName",value:function(){this.formFields.user.setCustomValidity(this.errorMessages.user.userNameAlreadyInUse),this.form.reportValidity()}},{key:"validateForm",value:function(){var e=this.formFields,a=e.name,t=e.email,r=e.user,s=e.pass,i=e.passConfirm;return Object.values(this.formFields).forEach((function(e){e&&e.setCustomValidity("")})),a.validity.tooShort&&a.setCustomValidity(this.errorMessages.name.PleaseEnterName),t.validity.patternMismatch&&t.setCustomValidity(this.errorMessages.email.PleaseEnterValidEmail),r.validity.tooShort&&r.setCustomValidity(this.errorMessages.user.PleaseChooseUserName),!this.userIsLoggedIn()&&s.validity.tooShort&&s.setCustomValidity(this.errorMessages.pass.PasswordMinimumLength),this.signup&&s.value!==i.value&&s.setCustomValidity(this.errorMessages.pass.PasswordsDontMatch),this.form.reportValidity()}}],i&&t(r.prototype,i),n&&t(r,n),Object.defineProperty(r,"prototype",{writable:!1}),e}(),n=function(e){var a=e.heading,t=e.body,r=e.keyboard,s=e.backdrop,i=$("[data-name=modal-alert]").modal({show:!1,keyboard:r,backdrop:s});return $("[data-name=modal-alert] .modal-header [data-name=modal-title]").text(a),$("[data-name=modal-alert] [data-name=modal-body] p").empty().append(t),$("[data-name=modal-alert] button").click((function(e){e.preventDefault(),i.modal("hide")})),i},o=Nogin._,d=function(e){return e.find("[data-name=ok]")},l=function(e){return e.find("[data-name=action1]")},u=function(){var e,a,t,r,s,i;return e="[data-name=account-form]",a={heading:o("Signup"),subheading:o("PleaseTellUsAboutYourself"),action1:o("Cancel"),action2:o("Submit")},t=a.heading,r=a.subheading,s=a.action1,i=a.action2,$(e+" h1.dialog").text(t),$(e+" h2.dialog").text(r),$(e+" [data-name=action1]").text(s),$(e+" [data-name=action2]").text(i),$(e)},m=function(){return n({heading:o("AccountCreatedSignup"),body:o("PleaseCheckEmailForVerificationLink",{lb:$("<br/>")[0]}),keyboard:!1,backdrop:"static"})},c=function(e){var a=e.type;return n({heading:o("error"),body:o(a,{lb:$("<br/>")[0]}),keyboard:!1,backdrop:"static"})};(function(){return $("#name-tf")})().focus();var f,h,g,y,v,p,b,k,w,P,E=u(),F=function(){Nogin.redirect("root")};l(E).click(F),f=new i({signup:!0}),h=E,y=(g={checkXSRF:!1,validate:function(){f.validateForm()},success:function(e,a,t,r){var s;"success"===a&&(s=m(),d(s).click((function(){setTimeout(F,3e3)})),s.modal("show"))},error:function(e){switch(e.responseText){case"email-taken":f.showInvalidEmail();break;case"username-taken":f.showInvalidUserName();break;default:c({type:"DispatchActivationLinkError"}).modal("show")}}}).validate,v=g.url,p=g.beforeSubmit,b=g.success,k=g.error,w=g.checkXSRF,P=void 0===w||w,h[0].addEventListener("change",(function(e){y(e)}),!0),h[0].addEventListener("input",(function(e){var a=e.target;a.setCustomValidity(""),a.checkValidity("")}),!0),!P||e||Nogin.disableXSRF?h.ajaxForm({headers:{"X-XSRF-Token":e},url:v,beforeSubmit:p,success:b,error:k}):k({responseText:"UnknownError"})}();
//# sourceMappingURL=signupController.iife.min.js.map
