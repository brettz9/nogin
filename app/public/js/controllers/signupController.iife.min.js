!function(){"use strict";function e(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function a(e,a){for(var t=0;t<a.length;t++){var s=a[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var t=Nogin._,s={getForm:function(){return $("[data-name=account-form]")[0]},getUserId:function(){return $("#userId")},getFormFields:function(){return{name:$('[data-name="name"]')[0],email:$('[data-name="email"]')[0],user:$('[data-name="user"]')[0],pass:$('[data-name="pass"]')[0],passConfirm:$('[data-name="pass-confirm"]')&&$('[data-name="pass-confirm"]')[0]}},errorMessages:{name:{PleaseEnterName:t("PleaseEnterName")},email:{emailAddressAlreadyInUse:t("emailAddressAlreadyInUse"),PleaseEnterValidEmail:t("PleaseEnterValidEmail")},user:{userNameAlreadyInUse:t("userNameAlreadyInUse"),PleaseChooseUserName:t("PleaseChooseUserName")},pass:{PasswordMinimumLength:t("PasswordMinimumLength"),PasswordsDontMatch:t("PasswordsDontMatch")}}},r=function(){function t(){var a=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.signup;e(this,t),this.signup=i,this.form=s.getForm(),this.formFields=s.getFormFields(),this.userId=s.getUserId(),this.errorMessages=s.errorMessages,this.userIsLoggedIn=function(e){return a.userId.val()&&""===e}}var r,i,n;return r=t,(i=[{key:"showInvalidEmail",value:function(){this.formFields.email.setCustomValidity(this.errorMessages.email.emailAddressAlreadyInUse),this.form.reportValidity()}},{key:"showInvalidUserName",value:function(){this.formFields.user.setCustomValidity(this.errorMessages.user.userNameAlreadyInUse),this.form.reportValidity()}},{key:"validateForm",value:function(){var e=this.formFields,a=e.name,t=e.email,s=e.user,r=e.pass,i=e.passConfirm;return Object.values(this.formFields).forEach((function(e){e&&e.setCustomValidity("")})),a.validity.tooShort&&a.setCustomValidity(this.errorMessages.name.PleaseEnterName),t.validity.patternMismatch&&t.setCustomValidity(this.errorMessages.email.PleaseEnterValidEmail),s.validity.tooShort&&s.setCustomValidity(this.errorMessages.user.PleaseChooseUserName),!this.userIsLoggedIn()&&r.validity.tooShort&&r.setCustomValidity(this.errorMessages.pass.PasswordMinimumLength),this.signup&&r.value!==i.value&&r.setCustomValidity(this.errorMessages.pass.PasswordsDontMatch),this.form.reportValidity()}}])&&a(r.prototype,i),n&&a(r,n),t}(),i=function(e){var a=e.heading,t=e.body,s=e.keyboard,r=e.backdrop;return $("[data-name=modal-alert]").modal({show:!1,keyboard:s,backdrop:r}),$("[data-name=modal-alert] .modal-header [data-name=modal-title]").text(a),$("[data-name=modal-alert] [data-name=modal-body] p").empty().append(t),$("[data-name=modal-alert]")},n=Nogin._,o=function(e){return e.find("[data-name=ok]")},d=function(e){return e.find("[data-name=action1]")},l=function(){var e,a,t,s,r,i;return e="[data-name=account-form]",a={heading:n("Signup"),subheading:n("PleaseTellUsAboutYourself"),action1:n("Cancel"),action2:n("Submit")},t=a.heading,s=a.subheading,r=a.action1,i=a.action2,$(e+" h1.dialog").text(t),$(e+" h2.dialog").text(s),$(e+" [data-name=action1]").text(r),$(e+" [data-name=action2]").text(i),$(e)},m=function(){return i({heading:n("AccountCreatedSignup"),body:n("PleaseCheckEmailForVerificationLink",{lb:$("<br/>")[0]}),keyboard:!1,backdrop:"static"})},u=function(e){var a=e.type;return i({heading:n("error"),body:n(a,{lb:$("<br/>")[0]}),keyboard:!1,backdrop:"static"})};(function(){return $("#name-tf")})().focus();var c,h,f,g,y,p,v,b,k=l(),I=function(){Nogin.redirect("root")};d(k).click(I),c=new r({signup:!0}),h=k,g=(f={validate:function(){c.validateForm()},success:function(e,a,t,s){var r;"success"===a&&(r=m(),o(r).click((function(){setTimeout(I,3e3)})),r.modal("show"))},error:function(e){switch(e.responseText){case"email-taken":c.showInvalidEmail();break;case"username-taken":c.showInvalidUserName();break;default:u({type:"DispatchActivationLinkError"}).modal("show")}}}).validate,y=f.url,p=f.beforeSubmit,v=f.success,b=f.error,h[0].addEventListener("change",(function(e){g(e)}),!0),h[0].addEventListener("input",(function(e){var a=e.target;a.setCustomValidity(""),a.checkValidity("")}),!0),h.ajaxForm({url:y,beforeSubmit:p,success:v,error:b})}();
//# sourceMappingURL=signupController.iife.min.js.map
